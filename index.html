<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Frida - An√°lisis Colaborativo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .header h1 {
            color: #2d3748;
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 800;
        }
        
        .header p {
            color: #718096;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }
        
        .collaboration-info {
            background: #e6fffa;
            border: 2px solid #38b2ac;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }
        
        .metric-value {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 10px;
        }
        
        .metric-label {
            color: #718096;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .critical { color: #e53e3e; }
        .warning { color: #dd6b20; }
        .good { color: #38a169; }
        .info { color: #3182ce; }
        
        .section {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .section-header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px 30px;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .section-content {
            padding: 30px;
        }
        
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
            min-height: 400px;
        }
        
        .chart-title {
            text-align: center;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2d3748;
        }
        
        .chart-canvas {
            position: relative;
            height: 300px !important;
        }
        
        .comparison-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .risk-section {
            background: linear-gradient(135deg, #fed7d7 0%, #fbb6ce 100%);
            border-left: 6px solid #e53e3e;
            padding: 25px;
            border-radius: 15px;
        }
        
        .protection-section {
            background: linear-gradient(135deg, #c6f6d5 0%, #9ae6b4 100%);
            border-left: 6px solid #38a169;
            padding: 25px;
            border-radius: 15px;
        }
        
        .factor-list {
            list-style: none;
            padding: 0;
        }
        
        .factor-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .factor-name {
            font-weight: 600;
            flex: 1;
        }
        
        .factor-score {
            font-size: 1.5rem;
            font-weight: 800;
            padding: 8px 15px;
            border-radius: 20px;
            color: white;
            min-width: 60px;
            text-align: center;
        }
        
        .score-critical { background: #e53e3e; }
        .score-high { background: #dd6b20; }
        .score-moderate { background: #f59e0b; }
        .score-good { background: #38a169; }
        
        .alerts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .alert {
            padding: 25px;
            border-radius: 15px;
            border-left: 6px solid;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .alert-critical {
            background: linear-gradient(135deg, #fed7d7 0%, #feb2b2 100%);
            border-color: #e53e3e;
        }
        
        .alert-warning {
            background: linear-gradient(135deg, #feebc8 0%, #fbd38d 100%);
            border-color: #dd6b20;
        }
        
        .alert-success {
            background: linear-gradient(135deg, #c6f6d5 0%, #9ae6b4 100%);
            border-color: #38a169;
        }
        
        .alert h4 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .demographics-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .demo-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .demo-card h4 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 700;
        }
        
        .demo-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .demo-item:last-child {
            border-bottom: none;
        }
        
        .collaboration-section {
            background: linear-gradient(135deg, #e6fffa 0%, #b2f5ea 100%);
            border: 3px solid #38b2ac;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }
        
        .collab-form {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(66, 153, 225, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(72, 187, 120, 0.4);
        }
        
        .discussion {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .discussion-header {
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        
        .discussion-author {
            font-weight: 700;
            color: #2d3748;
            font-size: 1.1rem;
        }
        
        .discussion-time {
            color: #718096;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .discussion-question {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .response {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0 15px 30px;
            border-left: 4px solid #4299e1;
        }
        
        .response-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .response-author {
            font-weight: 600;
            color: #2d3748;
        }
        
        .response-likes {
            background: #ebf8ff;
            color: #3182ce;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .response-likes:hover {
            background: #3182ce;
            color: white;
        }
        
        .response-form {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .response-form input {
            flex: 1;
        }
        
        .badge {
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
        }
        
        .badge-critical { background: #fed7d7; color: #c53030; }
        .badge-warning { background: #feebc8; color: #c05621; }
        .badge-good { background: #c6f6d5; color: #2f855a; }
        
        .plan-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .plan-card {
            border-radius: 15px;
            padding: 25px;
            border-left: 6px solid;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .plan-card:hover {
            transform: translateY(-3px);
        }
        
        .plan-immediate {
            background: linear-gradient(135deg, #fed7d7 0%, #fbb6ce 100%);
            border-color: #e53e3e;
        }
        
        .plan-short {
            background: linear-gradient(135deg, #feebc8 0%, #f6e05e 100%);
            border-color: #dd6b20;
        }
        
        .plan-maintain {
            background: linear-gradient(135deg, #c6f6d5 0%, #68d391 100%);
            border-color: #38a169;
        }
        
        .timeline {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .timeline-item {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .timeline-item:hover {
            background: #ebf8ff;
            transform: translateX(5px);
        }
        
        .timeline-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 20px;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .timeline-content {
            flex: 1;
        }
        
        .timeline-title {
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .timeline-desc {
            color: #718096;
            line-height: 1.5;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }
        
        .notification.error {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .metric-value {
                font-size: 2.5rem;
            }
            
            .response-form {
                flex-direction: column;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .comparison-section {
                grid-template-columns: 1fr;
            }
        }
        
        .footer {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-top: 40px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .url-share {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: monospace;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üìä Dashboard Frida</h1>
            <p>An√°lisis Colaborativo de Factores de Riesgo y Protecci√≥n</p>
            <p><strong>54 estudiantes de ESO evaluados</strong></p>
            
            <div class="collaboration-info">
                <strong>üöÄ Dashboard con gr√°ficos mejorados y sistema colaborativo</strong><br>
                <span id="activeUsers">5</span> colaboradores activos ‚Ä¢ 
                <span id="discussionCount">0</span> discusiones abiertas
            </div>
        </div>

        <!-- M√©tricas Clave -->
        <div class="section">
            <div class="section-header">üìà M√©tricas Clave</div>
            <div class="section-content">
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value info">54</div>
                        <div class="metric-label">Total Estudiantes</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value warning">9.57</div>
                        <div class="metric-label">IVG Promedio</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value good">3.23</div>
                        <div class="metric-label">Media Anterior</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value critical">7.4%</div>
                        <div class="metric-label">% Repetidores</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alertas Cr√≠ticas -->
        <div class="section">
            <div class="section-header">üö® Alertas Cr√≠ticas</div>
            <div class="section-content">
                <div class="alerts-grid">
                    <div class="alert alert-critical">
                        <h4>üö® CR√çTICO: F5 Educaci√≥n Familiar</h4>
                        <p><strong>Puntuaci√≥n: 6.56 - LA M√ÅS BAJA</strong></p>
                        <p>Requiere intervenci√≥n inmediata. D√©ficit severo en programas de formaci√≥n parental sobre prevenci√≥n de drogas.</p>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-primary" onclick="focusOnQuestion('F5')">üí¨ Discutir Soluciones Urgentes</button>
                        </div>
                    </div>
                    <div class="alert alert-warning">
                        <h4‚ö†Ô∏è ALTO RIESGO: F1 Reacci√≥n Familiar</h4>
                        <p><strong>Puntuaci√≥n: 9.26</strong></p>
                        <p>Necesario mejorar el manejo familiar de situaciones de riesgo. Programas de entrenamiento parental requeridos.</p>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-primary" onclick="focusOnQuestion('F1')">üí° Ver Estrategias</button>
                        </div>
                    </div>
                    <div class="alert alert-success">
                        <h4>‚úÖ FORTALEZAS: F6 y F7</h4>
                        <p><strong>Puntuaciones: 10.98 - EXCELENTES</strong></p>
                        <p>Actividades protectoras y estilo educativo funcionan muy bien. Mantener y potenciar estos aspectos.</p>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-success" onclick="focusOnQuestion('F6')">üöÄ Potenciar Fortalezas</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- An√°lisis Visual de Factores -->
        <div class="section">
            <div class="section-header">üìä An√°lisis Visual de Factores</div>
            <div class="section-content">
                <div class="charts-grid">
                    <!-- Gr√°fico de Barras General -->
                    <div class="chart-container">
                        <div class="chart-title">Puntuaciones por Factor</div>
                        <canvas id="factorsBarChart" class="chart-canvas"></canvas>
                    </div>
                    
                    <!-- Gr√°fico de Distribuci√≥n por Tipo -->
                    <div class="chart-container">
                        <div class="chart-title">Comparativa Riesgo vs Protecci√≥n</div>
                        <canvas id="riskProtectionChart" class="chart-canvas"></canvas>
                    </div>
                </div>
                
                <!-- Comparaci√≥n Visual Riesgo vs Protecci√≥n -->
                <div class="comparison-section">
                    <div class="risk-section">
                        <h3 style="color: #c53030; margin-bottom: 20px; text-align: center;">üö® FACTORES DE RIESGO</h3>
                        <ul class="factor-list">
                            <li class="factor-item">
                                <span class="factor-name">F1 Reacci√≥n Familiar</span>
                                <span class="factor-score score-high">9.26</span>
                            </li>
                            <li class="factor-item">
                                <span class="factor-name">F2 Grupo Amigos</span>
                                <span class="factor-score score-moderate">6.87</span>
                            </li>
                            <li class="factor-item">
                                <span class="factor-name">F3 Acceso Drogas</span>
                                <span class="factor-score score-high">8.00</span>
                            </li>
                            <li class="factor-item">
                                <span class="factor-name">F4 Riesgo Familiar</span>
                                <span class="factor-score score-moderate">6.69</span>
                            </li>
                        </ul>
                        <div style="text-align: center; margin-top: 20px;">
                            <strong style="color: #c53030;">PROMEDIO RIESGO: 7.71</strong>
                        </div>
                    </div>
                    
                    <div class="protection-section">
                        <h3 style="color: #2f855a; margin-bottom: 20px; text-align: center;">‚úÖ FACTORES DE PROTECCI√ìN</h3>
                        <ul class="factor-list">
                            <li class="factor-item">
                                <span class="factor-name">F5 Educaci√≥n Familiar</span>
                                <span class="factor-score score-critical">6.56</span>
                            </li>
                            <li class="factor-item">
                                <span class="factor-name">F6 Actividades Protectoras</span>
                                <span class="factor-score score-good">10.98</span>
                            </li>
                            <li class="factor-item">
                                <span class="factor-name">F7 Estilo Educativo</span>
                                <span class="factor-score score-good">10.98</span>
                            </li>
                        </ul>
                        <div style="text-align: center; margin-top: 20px;">
                            <strong style="color: #2f855a;">PROMEDIO PROTECCI√ìN: 9.51</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Perfil de Riesgo -->
        <div class="section">
            <div class="section-header">üìä Perfil de Riesgo de la Muestra</div>
            <div class="section-content">
                <div class="chart-container" style="max-width: 600px; margin: 0 auto;">
                    <div class="chart-title">Distribuci√≥n por Nivel de Vulnerabilidad</div>
                    <canvas id="riskProfileChart" class="chart-canvas"></canvas>
                </div>
            </div>
        </div>

        <!-- Datos Demogr√°ficos -->
        <div class="section">
            <div class="section-header">üë• Datos Demogr√°ficos</div>
            <div class="section-content">
                <div class="demographics-section">
                    <div class="demo-card">
                        <h4>Distribuci√≥n por Sexo</h4>
                        <div class="demo-item">
                            <span>Masculino:</span>
                            <strong>33 estudiantes (61.1%)</strong>
                        </div>
                        <div class="demo-item">
                            <span>Femenino:</span>
                            <strong>20 estudiantes (37.0%)</strong>
                        </div>
                        <div class="demo-item">
                            <span>No especificado:</span>
                            <strong>1 estudiante (1.9%)</strong>
                        </div>
                    </div>
                    
                    <div class="demo-card">
                        <h4>Situaci√≥n de Convivencia</h4>
                        <div class="demo-item">
                            <span>Ambos padres:</span>
                            <strong>24 estudiantes (44.4%)</strong>
                        </div>
                        <div class="demo-item">
                            <span>Solo madre:</span>
                            <strong>19 estudiantes (35.2%)</strong>
                        </div>
                        <div class="demo-item">
                            <span>Solo padre:</span>
                            <strong>4 estudiantes (7.4%)</strong>
                        </div>
                        <div class="demo-item">
                            <span>Otros familiares:</span>
                            <strong>4 estudiantes (7.4%)</strong>
                        </div>
                    </div>
                </div>

                <div class="alert alert-warning" style="margin-top: 30px;">
                    <h4>üìä Observaci√≥n Cr√≠tica</h4>
                    <p><strong>42.6% de los estudiantes vive en familias monoparentales</strong>, lo que requiere estrategias de intervenci√≥n espec√≠ficas y mayor apoyo social coordinado.</p>
                </div>
            </div>
        </div>

        <!-- Sistema de Colaboraci√≥n -->
        <div class="collaboration-section">
            <h2>üí¨ Sistema de Colaboraci√≥n Activo</h2>
            <p style="font-size: 1.2rem; margin: 15px 0;">
                <strong>¬°Participa en tiempo real!</strong> A√±ade preguntas, comenta y colabora con tu equipo.
            </p>

            <div class="collab-form">
                <h3 style="margin-bottom: 20px; color: #2d3748;">üó®Ô∏è Nueva Pregunta o Discusi√≥n</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="authorInput">üë§ Tu nombre/cargo:</label>
                        <input type="text" id="authorInput" placeholder="Ej: Dr. Garc√≠a - Coordinador de Orientaci√≥n">
                    </div>
                    <div class="form-group">
                        <label for="priorityInput">üìã Prioridad:</label>
                        <select id="priorityInput">
                            <option value="baja">üü¢ Baja - Informaci√≥n general</option>
                            <option value="media" selected>üü° Media - Decisi√≥n importante</option>
                            <option value="alta">üî¥ Alta - Requiere acci√≥n inmediata</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="questionInput">‚ùì Pregunta o tema de discusi√≥n:</label>
                    <textarea id="questionInput" placeholder="¬øQu√© aspecto del an√°lisis Frida quieres discutir con el equipo? Por ejemplo: ¬øC√≥mo priorizamos las intervenciones? ¬øQu√© recursos necesitamos?"></textarea>
                </div>
                <button class="btn btn-primary" onclick="addQuestion()">üìù Publicar Pregunta</button>
            </div>
        </div>

        <!-- Discusiones -->
        <div class="section">
            <div class="section-header">üó®Ô∏è Discusiones Activas</div>
            <div class="section-content">
                <div id="discussionsContainer">
                    <!-- Se generar√° din√°micamente -->
                </div>
            </div>
        </div>

        <!-- Plan de Acci√≥n -->
        <div class="section">
            <div class="section-header">üìã Plan de Acci√≥n Colaborativo</div>
            <div class="section-content">
                <div class="plan-grid">
                    <div class="plan-card plan-immediate">
                        <h4 style="color: #c53030; margin-bottom: 20px;">üö® Acci√≥n Inmediata (0-2 semanas)</h4>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h5 style="margin-bottom: 10px;">Programa F5 - Educaci√≥n Familiar</h5>
                            <p style="margin-bottom: 15px; color: #7f1d1d;"><strong>Cr√≠tico:</strong> Puntuaci√≥n m√°s baja (6.56)</p>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                <span class="badge badge-critical">Responsable: Orientaci√≥n</span>
                                <span class="badge badge-critical">Plazo: 2 semanas</span>
                            </div>
                        </div>
                    </div>

                    <div class="plan-card plan-short">
                        <h4 style="color: #c05621; margin-bottom: 20px;">‚è∞ Corto Plazo (1-3 meses)</h4>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h5 style="margin-bottom: 10px;">Apoyo Familias Monoparentales</h5>
                            <p style="margin-bottom: 15px; color: #92400e;"><strong>Importante:</strong> 42.6% de la muestra</p>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                <span class="badge badge-warning">Responsable: Equipos</span>
                                <span class="badge badge-warning">Plazo: 1 mes</span>
                            </div>
                        </div>
                    </div>

                    <div class="plan-card plan-maintain">
                        <h4 style="color: #2f855a; margin-bottom: 20px;">üöÄ Potenciar Fortalezas (Continuo)</h4>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <h5 style="margin-bottom: 10px;">Ampliar Actividades F6/F7</h5>
                            <p style="margin-bottom: 15px; color: #166534;"><strong>Fortaleza:</strong> Puntuaciones altas (10.98)</p>
                            <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                <span class="badge badge-good">Responsable: Ed. F√≠sica</span>
                                <span class="badge badge-good">Plazo: Continuo</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cronograma -->
        <div class="section">
            <div class="section-header">üìÖ Cronograma de Implementaci√≥n</div>
            <div class="section-content">
                <div class="timeline">
                    <div class="timeline-item">
                        <div class="timeline-dot" style="background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);"></div>
                        <div class="timeline-content">
                            <div class="timeline-title">Semana 1-2: Preparaci√≥n F5</div>
                            <div class="timeline-desc">Dise√±o urgente del programa de educaci√≥n familiar sobre drogas. <strong>Responsables:</strong> Dr. Garc√≠a, Prof. Mart√≠nez. <strong>Recursos necesarios:</strong> Material did√°ctico, espacio formativo.</div>
                        </div>
                        <button class="btn btn-primary" onclick="focusOnQuestion('cronograma-prep')">üí¨ Comentar</button>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot" style="background: linear-gradient(135deg, #ed8936 0%, #dd6b20 100%);"></div>
                        <div class="timeline-content">
                            <div class="timeline-title">Mes 1: Lanzamiento</div>
                            <div class="timeline-desc">Inicio talleres parentales y programas de apoyo para familias monoparentales. <strong>Responsables:</strong> Equipo completo. <strong>Seguimiento:</strong> Semanal.</div>
                        </div>
                        <button class="btn btn-primary" onclick="focusOnQuestion('cronograma-launch')">üí¨ Comentar</button>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot" style="background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%);"></div>
                        <div class="timeline-content">
                            <div class="timeline-title">Mes 2-3: Evaluaci√≥n</div>
                            <div class="timeline-desc">Primera evaluaci√≥n de efectividad y ajustes necesarios. <strong>Responsables:</strong> Orientaci√≥n y Equipos. <strong>Indicadores:</strong> Participaci√≥n, feedback familias.</div>
                        </div>
                        <button class="btn btn-primary" onclick="focusOnQuestion('cronograma-eval')">üí¨ Comentar</button>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-dot" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);"></div>
                        <div class="timeline-content">
                            <div class="timeline-title">Mes 4+: Consolidaci√≥n</div>
                            <div class="timeline-desc">Mantenimiento y mejora continua de todos los programas. <strong>Responsables:</strong> Todos. <strong>Meta:</strong> Mejora sostenida en F5 y mantenimiento de fortalezas.</div>
                        </div>
                        <button class="btn btn-success" onclick="focusOnQuestion('cronograma-consol')">üí¨ Comentar</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <h3>üîó Compartir Dashboard</h3>
            <p>Para colaborar con tu equipo, comparte esta URL:</p>
            <div class="url-share" id="currentUrl">
                <!-- Se generar√° autom√°ticamente -->
            </div>
            <p style="margin-top: 15px; color: #718096;">
                <strong>üìä Dashboard Frida v3.0</strong> | 
                Gr√°ficos mejorados y sistema colaborativo | 
                Datos actualizados: <span id="currentDate"></span>
            </p>
        </div>
    </div>

    <script>
        // Datos del an√°lisis Frida
        const fridaData = {
            factors: [
                { name: 'F1 Reacci√≥n Familia', shortName: 'F1', value: 9.26, type: 'riesgo', color: '#dd6b20' },
                { name: 'F2 Grupo Amigos', shortName: 'F2', value: 6.87, type: 'riesgo', color: '#f59e0b' },
                { name: 'F3 Acceso Drogas', shortName: 'F3', value: 8.00, type: 'riesgo', color: '#dd6b20' },
                { name: 'F4 Riesgo Familiar', shortName: 'F4', value: 6.69, type: 'riesgo', color: '#f59e0b' },
                { name: 'F5 Educaci√≥n Familiar', shortName: 'F5', value: 6.56, type: 'protecci√≥n', color: '#e53e3e' },
                { name: 'F6 Actividades Protectoras', shortName: 'F6', value: 10.98, type: 'protecci√≥n', color: '#38a169' },
                { name: 'F7 Estilo Educativo', shortName: 'F7', value: 10.98, type: 'protecci√≥n', color: '#38a169' }
            ],
            riskProfile: [
                { label: 'Bajo riesgo', value: 25, color: '#38a169' },
                { label: 'Riesgo moderado', value: 50, color: '#f59e0b' },
                { label: 'Alto riesgo', value: 25, color: '#e53e3e' }
            ]
        };

        // Preguntas predefinidas
        const predefinedQuestions = {
            'F5': '¬øQu√© estrategias URGENTES proponen para mejorar la educaci√≥n familiar sobre drogas (F5: 6.56 - CR√çTICO)?',
            'F1': '¬øC√≥mo podemos ayudar a las familias a manejar mejor las situaciones de riesgo (F1: 9.26)?',
            'F6': '¬øC√≥mo potenciamos las actividades protectoras que ya funcionan bien (F6: 10.98)?',
            'cronograma-prep': '¬øQu√© recursos espec√≠ficos necesitamos para la preparaci√≥n del programa F5 en 2 semanas?',
            'cronograma-launch': '¬øC√≥mo organizamos el lanzamiento simult√°neo de talleres parentales y apoyo monoparental?',
            'cronograma-eval': '¬øQu√© indicadores espec√≠ficos usaremos para evaluar la efectividad en mes 2-3?',
            'cronograma-consol': '¬øC√≥mo garantizamos la sostenibilidad del programa a largo plazo?'
        };

        // Sistema de discusiones
        let discussions = JSON.parse(localStorage.getItem('fridaDiscussions')) || [
            {
                id: 1,
                author: "Dr. Garc√≠a - Coordinador",
                question: "¬øQu√© estrategias espec√≠ficas recomiendan para abordar el d√©ficit cr√≠tico en educaci√≥n familiar sobre drogas (F5: 6.56)?",
                responses: [
                    {
                        id: 1,
                        author: "Prof. Mart√≠nez - Orientaci√≥n",
                        response: "Propongo talleres mensuales obligatorios para padres con material audiovisual, casos pr√°cticos y seguimiento personalizado",
                        likes: 5,
                        timestamp: "Hace 2 horas"
                    },
                    {
                        id: 2,
                        author: "Psic. L√≥pez - Equipos",
                        response: "Necesitamos un programa diferenciado para familias monoparentales (42.6% de muestra). Horarios flexibles y apoyo digital",
                        likes: 3,
                        timestamp: "Hace 1 hora"
                    }
                ],
                priority: "alta",
                timestamp: "Hace 3 horas"
            },
            {
                id: 2,
                author: "Jefa Estudios",
                question: "¬øC√≥mo aprovechamos las fortalezas en F6 (Actividades: 10.98) y F7 (Estilo Educativo: 10.98) para reforzar las √°reas d√©biles?",
                responses: [
                    {
                        id: 3,
                        author: "Prof. Ruiz - Ed. F√≠sica",
                        response: "Crear programa de mentores familiares donde padres con buen estilo educativo apoyen a otros. Ampliar actividades fin de semana",
                        likes: 4,
                        timestamp: "Hace 30 min"
                    }
                ],
                priority: "media",
                timestamp: "Hace 1 d√≠a"
            }
        ];

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            initializeDashboard();
            createCharts();
            updateDiscussions();
            updateStats();
        });

        function initializeDashboard() {
            // Mostrar fecha actual
            document.getElementById('currentDate').textContent = new Date().toLocaleDateString('es-ES');
            
            // Mostrar URL actual
            document.getElementById('currentUrl').textContent = window.location.href;
            
            // Simular usuarios activos
            updateActiveUsers();
            setInterval(updateActiveUsers, 30000);
        }

        function updateActiveUsers() {
            const count = Math.floor(Math.random() * 4) + 3;
            document.getElementById('activeUsers').textContent = count;
        }

        function createCharts() {
            // Gr√°fico de barras de factores
            const factorsCtx = document.getElementById('factorsBarChart').getContext('2d');
            new Chart(factorsCtx, {
                type: 'bar',
                data: {
                    labels: fridaData.factors.map(f => f.shortName),
                    datasets: [{
                        label: 'Puntuaci√≥n',
                        data: fridaData.factors.map(f => f.value),
                        backgroundColor: fridaData.factors.map(f => f.color),
                        borderColor: fridaData.factors.map(f => f.color),
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                title: function(tooltipItems) {
                                    const index = tooltipItems[0].dataIndex;
                                    return fridaData.factors[index].name;
                                },
                                label: function(context) {
                                    return `Puntuaci√≥n: ${context.parsed.y}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 20,
                            grid: {
                                color: '#e2e8f0'
                            },
                            ticks: {
                                color: '#4a5568'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: '#4a5568',
                                font: {
                                    weight: 'bold'
                                }
                            }
                        }
                    }
                }
            });

            // Gr√°fico comparativo riesgo vs protecci√≥n
            const riskFactors = fridaData.factors.filter(f => f.type === 'riesgo');
            const protectionFactors = fridaData.factors.filter(f => f.type === 'protecci√≥n');
            
            const riskProtectionCtx = document.getElementById('riskProtectionChart').getContext('2d');
            new Chart(riskProtectionCtx, {
                type: 'radar',
                data: {
                    labels: ['F1', 'F2', 'F3', 'F4', 'F5', 'F6', 'F7'],
                    datasets: [{
                        label: 'Factores de Riesgo',
                        data: [9.26, 6.87, 8.00, 6.69, 0, 0, 0],
                        backgroundColor: 'rgba(239, 68, 68, 0.2)',
                        borderColor: '#ef4444',
                        borderWidth: 3,
                        pointBackgroundColor: '#ef4444',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#ef4444'
                    }, {
                        label: 'Factores de Protecci√≥n',
                        data: [0, 0, 0, 0, 6.56, 10.98, 10.98],
                        backgroundColor: 'rgba(56, 161, 105, 0.2)',
                        borderColor: '#38a169',
                        borderWidth: 3,
                        pointBackgroundColor: '#38a169',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#38a169'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 20,
                            grid: {
                                color: '#e2e8f0'
                            },
                            angleLines: {
                                color: '#e2e8f0'
                            },
                            pointLabels: {
                                color: '#4a5568',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#4a5568',
                                font: {
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });

            // Gr√°fico de perfil de riesgo
            const riskProfileCtx = document.getElementById('riskProfileChart').getContext('2d');
            new Chart(riskProfileCtx, {
                type: 'doughnut',
                data: {
                    labels: fridaData.riskProfile.map(r => r.label),
                    datasets: [{
                        data: fridaData.riskProfile.map(r => r.value),
                        backgroundColor: fridaData.riskProfile.map(r => r.color),
                        borderColor: '#fff',
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#4a5568',
                                font: {
                                    size: 14
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.parsed}% (~${Math.round(context.parsed * 54 / 100)} estudiantes)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function focusOnQuestion(factorCode) {
            const question = predefinedQuestions[factorCode] || `¬øQu√© opinan sobre ${factorCode}?`;
            
            document.getElementById('questionInput').value = question;
            document.getElementById('priorityInput').value = factorCode === 'F5' ? 'alta' : 'media';
            
            // Scroll al formulario
            document.querySelector('.collaboration-section').scrollIntoView({
                behavior: 'smooth'
            });
            
            // Focus en el campo de autor
            setTimeout(() => {
                document.getElementById('authorInput').focus();
            }, 500);
        }

        function addQuestion() {
            const author = document.getElementById('authorInput').value.trim();
            const question = document.getElementById('questionInput').value.trim();
            const priority = document.getElementById('priorityInput').value;

            if (!author || !question) {
                showNotification('Por favor, completa todos los campos', 'error');
                return;
            }

            const newDiscussion = {
                id: Date.now(),
                author: author,
                question: question,
                responses: [],
                priority: priority,
                timestamp: 'Ahora'
            };

            discussions.unshift(newDiscussion);
            saveDiscussions();
            updateDiscussions();
            updateStats();
            
            // Limpiar formulario
            document.getElementById('authorInput').value = '';
            document.getElementById('questionInput').value = '';
            document.getElementById('priorityInput').value = 'media';
            
            showNotification('¬°Pregunta a√±adida correctamente! Tu equipo puede verla ahora.', 'success');
            
            // Scroll a discusiones
            setTimeout(() => {
                document.querySelector('#discussionsContainer').scrollIntoView({
                    behavior: 'smooth'
                });
            }, 1000);
        }

        function addResponse(discussionId) {
            const input = document.getElementById(`response-${discussionId}`);
            const responseText = input.value.trim();

            if (!responseText) {
                showNotification('Escribe una respuesta', 'error');
                return;
            }

            const discussion = discussions.find(d => d.id === discussionId);
            if (discussion) {
                discussion.responses.push({
                    id: Date.now(),
                    author: "Usuario Actual",
                    response: responseText,
                    likes: 0,
                    timestamp: "Ahora"
                });

                input.value = '';
                saveDiscussions();
                updateDiscussions();
                showNotification('Respuesta a√±adida', 'success');
            }
        }

        function likeResponse(discussionId, responseId) {
            const discussion = discussions.find(d => d.id === discussionId);
            if (discussion) {
                const response = discussion.responses.find(r => r.id === responseId);
                if (response) {
                    response.likes++;
                    saveDiscussions();
                    updateDiscussions();
                }
            }
        }

        function updateDiscussions() {
            const container = document.getElementById('discussionsContainer');
            
            if (discussions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #718096;">
                        <h3>No hay discusiones a√∫n</h3>
                        <p>¬°S√© el primero en a√±adir una pregunta para tu equipo!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = discussions.map(discussion => {
                const priorityClass = discussion.priority === 'alta' ? 'critical' : 
                                   discussion.priority === 'media' ? 'warning' : 'good';
                
                return `
                    <div class="discussion">
                        <div class="discussion-header">
                            <div class="discussion-author">${discussion.author}</div>
                            <div class="discussion-time">
                                ${discussion.timestamp} | 
                                <span class="badge badge-${priorityClass}">
                                    Prioridad ${discussion.priority.toUpperCase()}
                                </span>
                            </div>
                        </div>
                        <div class="discussion-question">
                            <strong>${discussion.question}</strong>
                        </div>
                        
                        ${discussion.responses.map(response => `
                            <div class="response">
                                <div class="response-header">
                                    <div>
                                        <span class="response-author">${response.author}</span>
                                        <span style="color: #718096; font-size: 0.9em; margin-left: 10px;">${response.timestamp}</span>
                                    </div>
                                    <div class="response-likes" onclick="likeResponse(${discussion.id}, ${response.id})">
                                        üëç ${response.likes}
                                    </div>
                                </div>
                                <div>${response.response}</div>
                            </div>
                        `).join('')}
                        
                        <div class="response-form">
                            <input type="text" id="response-${discussion.id}" placeholder="Escribe tu respuesta...">
                            <button class="btn btn-primary" onclick="addResponse(${discussion.id})">üì§ Enviar</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateStats() {
            document.getElementById('discussionCount').textContent = discussions.length;
        }

        function saveDiscussions() {
            localStorage.setItem('fridaDiscussions', JSON.stringify(discussions));
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 4000);
        }

        // Simular actividad
        setInterval(() => {
            const messages = [
                'Prof. Ruiz ha comentado sobre actividades protectoras',
                'Dr. Garc√≠a ha evaluado el cronograma',
                'Nuevo miembro se ha unido al dashboard',
                'Psic. L√≥pez ha dado like a una respuesta'
            ];
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            showNotification(randomMessage, 'success');
        }, 120000);
    </script>
</body>
</html>